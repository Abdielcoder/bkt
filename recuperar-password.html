<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./assets/icons/favicon.ico" />
    <title>Tu Taxi | Recuperar contrase침a</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./css/index.css" />
  </head>

  <body>
    <div class="container">
      <div class="bg_logo"></div>
      <div class="form_container">
        <div class="sub_form">
          <div class="loginForm">
            <div class="floating-image-container">
              <img src="./assets/img/jalisco.png" alt="Jalisco" /> 
            </div> 
            <h2>Tu taxi</h2>
            <p>Portal Administrativo</p>
            <form id="recover">
              <label for="loginEmail">Introduce tu correo electr칩nico</label>
              <input class="form_input" id="loginEmail" type="email" placeholder="Correo electronico" required />
              <input id="loginSubmit" type="submit" value="Reestablecer contrase침a" />
              <a href="./index.html">Volver al Login</a> 
              <p>Copyright &copy; <u>TuTaxi Backoffice.</u></p>
            </form>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-auth.js"></script>
<script type="module" src="./js/config/auth-config.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-storage.js"></script>

<script type="text/javascript">
  document.querySelector("form#recover").addEventListener("submit", async function (e) {
    e.preventDefault();
    const email = document.querySelector("#loginEmail").value;
    const emailSends = await resetPasswordToUser(email);
    if (emailSends) {
      window.location.assign("http://127.0.0.1:5500/index.html");
    }
  });

  const resetPasswordToUser = async (email) => {
    try {
      await firebase.auth().sendPasswordResetEmail(email);
      alert(
        "Se le ha enviado un correo de validacion y restablecimiento de contrase침a al usuario, se requiere verificar su bandeja de entrada."
      );
      return true;
    } catch (error) {
      alert("Se ha presentado un error, favor de verificar");
      return false;
    }
  };
</script>
